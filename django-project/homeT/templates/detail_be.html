<h3>detail 페이지입니다</h3>
{{ detailObj.title}}
<iframe width="871" height="490" src="https://www.youtube.com/embed/{{detailObj.v_id}}" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<li>
    <input type="button" class="like" name="{{detailObj.id}}">
    <p id="count-{{videoObj.id}}">{{ detailObj.like_count }}개</p>

</li>

<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script type="text/javascript">
    $('.like').click(function(){
        var pk = $(this).attr('name')
        $.ajax({ // .like 버튼을 클릭하면 <새로고침> 없이 ajax로 서버와 통신하겠다.
            type: "POST",
            url : "{% url 'video_like' %}",
            data : {'pk':pk, 'csrfmiddlewaretoken': '{{csrf_token}}'},
            dataType : "json",

            // 서버측에서 전송한 Response 데이터 형식(json)
            // {'likes_count': video.like_count, 'message':message}

            success: function(response){
                alert(response.message);
                $("#count-"+pk).html(response.like_count+"개");
            },
            error: function(request, status, error){ //통신 실패시 로그인 페이지 리다이렉트
                alert('로그인이 필요합니다.')
                window.location.replace("/login/")
            },
        });
    })  

</script>